---
editor: 
  markdown: 
    wrap: 72
---

# Distinct functional responses of consumers and producers to climate drive mutualistic network asymmetry

## Modelling interaction assembly

To capture probabilistic patterns from interactions observed at the
continental scale, we tested four modes of interaction assembly: the
stochastic block model, the connectance model, the matching-trait model,
and the matching-centrality model. ([Terry and Lewis
2020](http://localhost:4649/references.html#ref-terry2020finding)). Each
model was evaluated based on its ability to estimate interaction
probabilities that best predict the observed binary interaction data.

For the trait, connectance, and matching-centrality models, parameters
were estimated with the Nelder–Mead algorithm via repeated
maximum-likelihood optimization, using multiple random starts and
averaging predictions from the best-fitting runs to avoid local optima.
The stochastic block model instead assigns species to discrete
interaction groups, such that interaction probabilities depend only on
group membership, and uses a degree-corrected bipartite SBM algorithm to
iteratively improve group assignments based on likelihood gains. To
stabilize inference, multiple SBM fits were performed and predictions
were averaged across the best solutions, yielding robust estimates of
group structure and block-level interaction probabilities.

### Stochastic Block Model (SBM)

The SBM assumes that networks exhibit a modular pattern, where subsets
of species interact predominantly within other groups of highly
connected species (Terry and Lewis, 2020). Interaction probabilities
depend only on the group membership of species, not on individual
species identities. Species are initially assigned to groups at random,
and the model iteratively improves these assignments by moving species
between groups to maximize the likelihood of the observed interaction
network. This optimization results in an incidence matrix, Z,
representing species-level group associations, and a squared matrix, Θ,
reflecting interaction probabilities within and between groups. The
likelihood (L) of the SBM is given by:

::: callout
#### Equation 1

$$P(a\_{ij} \> 0) = \omega\_{G_i G_j}$$

**where:** ($a_{ij}$) denotes the interaction between species ($i$) and
($j$); ($G_i$) and ($G_j$) are the interaction guild assignments of
species ($i$) and ($j$); and ($\omega_{G_i G_j}$) is the estimated
probability of interaction between species belonging to those two
guilds.
:::

### Connectance Model

In the connectance model species are characterized by continuous
connectivity scores that represent their tendency to interact broadly or
narrowly within the network. The model assumes a generalist–specialist
hierarchy, where interactions of specialist species are probabilistic
subsets of those of generalists, rather than arising from discrete
groups. Species connectivity scores are optimized by maximizing the
likelihood of reproducing the observed interaction matrix. The
likelihood (L) of the connectance model is given by:

::: callout
#### Equation 2

$$\operatorname{logit}!\left(P(a\_{ij} \> 0 \mid \mathbf{O})\right) =
c_i + c_j + k_C$$

**where:** ($a_{ij}$) denotes the interaction between species ($i$) and
($j$); ($c_i$) and ($c_j$) are species-specific connectivity parameters;
($k_C$) is a global intercept controlling overall connectance; and
($\mathbf{O}$) denotes the observed interaction network.
:::

### Matching-Trait Model

The matching-trait model assumes that interactions (Pᵢⱼ) are governed by
trait compatibility rather than by overall connectance or group
membership. Each species is positioned along one or more latent trait
axes, and interaction probabilities increase when consumer and resource
trait values are closely aligned. Model parameters are optimized by
maximizing the likelihood of the observed interaction matrix.

::: callout
#### Equation 3

$$\operatorname{logit}!\left(P(a\_{ij} \> 0 \mid \mathbf{O})\right) =
-\lambda (m_i - m_j)\^2 + k_M$$

**where:** ($a_{ij}$) denotes the interaction between species ($i$) and
($j$); ($m_i$) and ($m_j$) are latent trait values for species ($i$) and
($j$); ($\lambda$) determines how rapidly interaction probability
declines with trait mismatch; ($k_M$) is a global intercept; and
($\mathbf{O}$) denotes the observed interaction network.
:::

### Matching-Centrality Model

The matching-centrality model integrates approaches from both the
connectance and matching-trait models. It simultaneously optimizes
species connectivity scores and trait axes to predict interactions. The
likelihood (L) for this model is:

::: callout
#### Equation 4

$$\operatorname{logit}!\left(P(a\_{ij} \> 0 \mid \mathbf{O})\right) =
c_i + c_j - \lambda (m_i - m_j)\^2 + k_B $$

**where:** ($a_{ij}$) denotes the interaction between species ($i$) and
($j$); ($m_i$) and ($m_j$) are latent trait positions of species ($i$)
and ($j$); ($\lambda$) controls the strength of trait matching; ($c_i$)
and ($c_j$) represent species-level connectivity effects; ($k_B$) is a
model intercept; and ($\mathbf{O}$) denotes the observed interaction
network.
:::

### Testing the accuracy of interaction assembly models

Following guidelines established by Poisot (2023), we evaluated the
accuracy of interaction assembly models using Youden’s J statistic.

::: callout
#### Equation 5

$$J = \text{sensitivity} + \text{specificity} - 1$$
:::

This metric quantifies a model’s ability to correctly distinguish
observed interactions from non-interactions by balancing sensitivity
(true positive rate) and specificity (true negative rate), and is
independent of interaction prevalence. For each model, predicted
interaction probabilities were converted to binary predictions using the
threshold that maximized Youden’s J, allowing direct comparison of
classification performance across alternative assembly hypotheses.In
this context, higher values of Youden’s J indicate greater support for a
given assembly model in reproducing observed interaction structure
beyond random expectation.

## Trait-based downscaling of ecological networks

### Using SBM to cluster species into interaction guilds

We used the stochastic block model (SBM) as our benchmark latent
variable model to capture probabilistic patterns from interactions that
are *observed* at the continental scale.

The output of this model is:

-   Incidence matrices reflecting species level associations to a group

-   Palms

![**Figure B1. Distribution of palm species across interaction guilds.**
Bar plot shows the number of palm species assigned to each interaction
guild, illustrating differences in species representation among guilds
and highlighting guilds with higher or lower palm
diversity.](images/clipboard-331260339.png)

-   Mammals

![**Figure B2. Distribution of mammal species across interaction
guilds.** Bar plot shows the number of mammal species assigned to each
interaction guild, highlighting variation in mammal representation among
guilds and differences in taxonomic richness across interaction
types.](images/clipboard-2171192370.png)

-   a squared matrix reflecting the probability of an interaction
    between species within and between interaction guilds

![**Figure B3: Heatmap of pairwise distances among interaction guilds.**
Darker red indicates greater strength of interaction between palm and
frugivore mammal species-guild combination. Values within heatmap tiles
represent the interaction strength expected between species from
interaction guild pairs.](images/clipboard-1469330877.png)

### Trait-based characterization of interaction guilds

Characterizing guilds through traits allow interaction patterns to be
interpreted in terms of ecological terms rather than topology alone. For
example, resource availability is reflected in palm fruit size, stem
height, and growth form, which determine which consumers can access and
exploit resources. Consumer foraging strategies are captured by mammal
diet composition, activity patterns, and body mass, distinguishing
guilds dominated by nocturnal generalist frugivores from those
structured around smaller, diurnal or crepuscular specialists.

![**Figure B4. Functional differentiation of palms across interaction
guilds.** Boxplots show variation in average fruit length and maximum
stem height (log-scaled) among interaction guilds, while the heatmap
indicates the proportional representation of erect and acaulescent
growth forms. Together, these patterns reveal distinct palm trait
syndromes associated with different interaction
guilds.](images/clipboard-2838496144.png)

![**Figure B5. Functional differentiation of mammals across interaction
guilds.** Heatmaps show the proportional composition of mammal diet
traits and activity patterns across interaction guilds, while boxplots
depict variation in mammalian body mass (log-scaled). Together, these
patterns reveal distinct mammal trait syndromes associated with
different interaction guilds, linking guild structure to differences in
foraging strategy, activity timing, and body
size.](images/clipboard-545621371.png)

### Interaction guild prediction

Given that we have information on the trait distribution of the species
we have estimated the probability of association with SBM. We use these
traits to train multinomial models that predict interaction guilds for
all other palm and mammal species in the neotropics without interaction
data but information on their traits.

We use multinomial logistic regression models to predict interaction
guilds with species trait data. We justify the choice of multinomial
logistic regression models as these can handle the prediction of
non-binary outcomes, that is in our case, the labeling of SBM groupings
per species. We extracted variable importance scores with combinations
of the absolute values of the model weights ([Gevrey, Dimopoulos, and
Lek 2003](http://localhost:4649/references.html#ref-gevrey2003review)).

![**Figure B6: Trait-based characterization of mammal–palm interaction
guilds.** (a) Scatterplot of mammal species body mass (log₁₀ grams)
versus percentage of fruit in diet (%), with point shapes indicating
diurnal activity (▲ = diurnal, ● = non-diurnal). Ellipses represent
trait distributions by interaction guild (IG 1–7). Mammal guilds cluster
distinctly along diet and body mass axes, reflecting ecological
divergence between small-bodied, highly frugivorous species (e.g. IG-1)
and large-bodied, low-frugivory taxa (e.g. IG-6). (b) Palm species
characterized by average fruit length (cm) and maximum stem height (m),
with ellipses showing trait space by guild and triangle symbols
indicating acaulescent forms (1 = acaulescent, 0 = caulescent). Palm
guilds occupy contrasting regions of trait space, from tall,
small-fruited species (e.g. IG-2) to short, large-fruited, acaulescent
types (e.g. IG-6).](images/clipboard-2989354878.png)

::: callout
#### Table B1. Trait composition of mammal and palm interaction guilds

Table summarizes species richness and mean trait values for mammal
frugivores and palms across interaction guilds 1–7. Values report
averages and variability of key functional traits, as well as the
proportional representation of activity patterns, diet components, and
growth forms, highlighting distinct trait syndromes associated with each
guild.

```{r}
#| echo: false
#| message: false
#| warning: false
library(tidyverse)
library(gt)

guild_tbl <- tribble(
  ~Taxa, ~Variable, ~`1`, ~`2`, ~`3`, ~`4`, ~`5`, ~`6`, ~`7`,
  "Mammal frugivores", "# species", 66, NA, 341, 33, NA, 15, 33,
  "Mammal frugivores", "Body mass (mean)", 6.47, NA, 4.75, 3.91, NA, 9.73, 8.15,
  "Mammal frugivores", "Percentage fruit in diet (mean)", 64.09, NA, 21.70, 48.48, NA, 20.00, 36.36,
  "Mammal frugivores", "Body mass (sd)", 1.68, NA, 1.33, 0.66, NA, 0.73, 0.52,
  "Mammal frugivores", "Percentage fruit in diet (sd)", 11.63, NA, 7.20, 3.64, NA, 12.54, 4.89,
  "Mammal frugivores", "Percentage diurnal", 0.48, NA, 0.22, 0.03, NA, 0.40, 0.79,
  "Mammal frugivores", "Percentage nocturnal", 0.52, NA, 0.84, 0.97, NA, 0.73, 0.24,
  "Mammal frugivores", "Percentage crepuscular", 0.08, NA, 0.10, 0.00, NA, 0.47, 0.30,

  "Palms", "# species", NA, 25, 15, NA, 265, 137, NA,
  "Palms", "Stem height (mean)", NA, 3.05, 3.45, NA, 1.95, 1.18, NA,
  "Palms", "Fruit length (mean)", NA, 0.80, 1.69, NA, 0.90, 1.39, NA,
  "Palms", "Stem height (sd)", NA, 0.27, 0.26, NA, 0.63, 0.96, NA,
  "Palms", "Fruit length (sd)", NA, 0.11, 0.40, NA, 0.31, 0.57, NA,
  "Palms", "Percentage acaulescent", NA, 0.00, 0.00, NA, 0.01, 0.36, NA,
  "Palms", "Percentage erect", NA, 1.00, 0.93, NA, 0.98, 0.64, NA
)

# Convert proportion-style percentage rows (0–1) to 0–100
pct_rows <- c(
  "Percentage diurnal",
  "Percentage nocturnal",
  "Percentage crepuscular",
  "Percentage acaulescent",
  "Percentage erect"
)

guild_tbl_fmt <-
  guild_tbl |>
  mutate(across(
    .cols = c(`1`,`2`,`3`,`4`,`5`,`6`,`7`),
    .fns  = ~ if_else(Variable %in% pct_rows, .x * 100, .x)
  ))

guild_gt <-
  guild_tbl_fmt |>
  gt(rowname_col = "Variable", groupname_col = "Taxa") |>
  tab_header(
    title = md("**Interaction guild**"),
    subtitle = md("Trait summaries by guild (1–7)")
  ) |>
  tab_spanner(
    label = "Interaction guild",
    columns = c(`1`,`2`,`3`,`4`,`5`,`6`,`7`)
  ) |>
  cols_label(
    `1` = "1", `2` = "2", `3` = "3", `4` = "4", `5` = "5", `6` = "6", `7` = "7"
  ) |>
  cols_align(
    align = "center",
    columns = c(`1`,`2`,`3`,`4`,`5`,`6`,`7`)
  ) |>
  # Default numeric formatting
  fmt_number(
    columns = c(`1`,`2`,`3`,`4`,`5`,`6`,`7`),
    decimals = 2
  ) |>
  # Percentage rows: show as percent with one decimal + % sign
  fmt_number(
    columns = c(`1`,`2`,`3`,`4`,`5`,`6`,`7`),
    rows = Variable %in% pct_rows,
    decimals = 1,
    suffix = "%"
  ) |>
  sub_missing(missing_text = "NA") |>
  tab_style(
    style = cell_text(align = "left"),
    locations = cells_stub()
  ) |>
  opt_table_outline() |>
  opt_row_striping()

guild_gt
```
:::

#### Important traits

![Figure B7. Variable importance from neural network models fitted with
caret. Bar plots show relative variable importance for the palm model
(left) and the mammal model (right), calculated using caret::varImp
applied to refitted neural network classifiers. For neural networks,
variable importance follows the method of Gevrey et al. (2003), in which
importance is derived from combinations of the absolute values of
connection weights linking each input variable to the hidden and output
layers. For classification models, class specific importances are
identical and are therefore shown as a single score per variable.
Importance values are scaled relative to the most influential predictor
within each model, enabling comparison across traits. Results indicate
that plant growth form strongly dominates the palm model, whereas mammal
activity patterns are the primary drivers of the mammal model, with
secondary contributions from diet and body
mass.](images/clipboard-2422444127.png)

### Building spatially explicit synthetic networks

#### Finding co-occuring assemblages at the grid-cell level

To identify local co-occurring assemblages of palms and mammals, we
converted species range polygons into presence-by-grid-cell
representations using a common spatial grid across the Neotropics. When
creating grids, we do not consider spherical geometries to avoid
topology artifacts (e.g., duplicate vertices) that can occur when
intersecting complex polygons as the spatial representations of species
ranges. We then created a 1° × 1° grid covering the Neotropics and
intersected the grid with each palm and mammal ranges to create *local*
species occurrences. These gridded palm and mammal presence layers can
then be combined per grid cell to define local palm assemblages, local
mammal assemblages, and ultimately co-occurring palm–mammal assemblages
used in downstream network construction and trait-based analyses.

![Figure B8. Spatial grid used to define local assemblages across the
Neotropics. Map shows the 1° × 1° spatial grid overlaid on the
Neotropical region. Grid cells provide the spatial units for
intersecting species range polygons and defining local palm and mammal
assemblages used in downstream co-occurrence and interaction network
analyses.](images/clipboard-1532803991.png)

#### Assembling grid-cell level networks

We use a composite interaction probability score that integrates
block-model interaction propensity, relative spatial overlap, and
geographic proximity, such that interactions are favored between species
assigned to compatible guilds, with overlapping ranges and short spatial
separation between their range centroids.

::: callout
#### Equation 6

$$s_{ij} = \left(\Omega_{G_i G_j}\right)\cdot \left(\frac{A_iA_j}{(A_i + A_j)^2}\right)\cdot\left(1 - \tilde d_{ij}\right)$$

**where:** ($s_{ij}$) is the final interaction score between palms ($i$)
and mammals ($j$); ($\Omega_{G_i G_j}$) is the stochastic block model
interaction probability between their guilds; ($A_i$) and ($A_j$) are
summed range areas; ($d_{ij}$) is the geographic distance between
centroids; ($\tilde d_{ij}$) is the min–max rescaled distance.
:::

This approach allowed us to recreate synthetic probabilistic
plant-mammal frugivore networks for each grid-cell across the
Neotropics, while accounting for the heterogeneity of species ranges
within each grid. We applied an exclusion criteria to the list of grids
before applying this network generating algorithm, and selected only
those grids with at least 5 palm and 5 mammal species.

## Evaluating functional changes in networks across environmental gradients

### Bioclimatic data

WorldClim bioclimatic variables are derived from long-term monthly
climate surfaces based on weather station records distributed globally.
WorldClim variables are generated by spatially interpolating station
data using thin-plate splines that incorporate elevation and other
covariates, producing continuous gridded climate surfaces that represent
regional climatic gradients across complex tropical topography. We used
the following as spatial predictors:

-   **Mean Annual Temperature (BIO01)** represents the average
    temperature over all months of the year and summarizes the overall
    thermal energy available to ecosystems.

-   **Total Annual Precipitation (BIO12)** is the sum of monthly
    precipitation values and captures the total annual water input to a
    region.

-   **Temperature Seasonality (BIO14)** quantifies the amount of
    temperature variation over the year, calculated as the standard
    deviation of monthly mean temperatures multiplied by 100, and
    reflects the degree of thermal variability.

-   **Precipitation Seasonality (BIO15)** measures the variability of
    monthly precipitation totals, expressed as the coefficient of
    variation, and indicates how evenly precipitation is distributed
    throughout the year.

![Figure B9. Climatic context of the Neotropics used in network analyses.
Spatial distributions of mean annual temperature, total annual
precipitation, precipitation seasonality, and temperature seasonality
across the Neotropics. Maps summarize the broad climatic gradients that
structure species distributions and interaction assemblages, and serve
as environmental predictors for assessing how climate modulates
functional richness and interaction guild
organization.](images/clipboard-2118027858.png)

### Measuring interaction guild diversity across the environmental gradient

We performed spatial joins to associate each grid-cell species
assemblage with corresponding bioclimatic variables. We then quantified
variation in the relative occupancy of interaction guilds inferred by
the stochastic block model by calculating, for each grid cell, the
proportion of palm or mammal species assigned to each interaction guild.
For a given assemblage, we first counted the number of palm species and
mammal species assigned to each interaction guild. These counts were
then normalized by the total number of species in each trophic level to
obtain proportional guild representations.

Unlike trait-space–based measures of functional richness that quantify
the volume of multivariate trait space occupied by species, our
network-based formulation captures diversity in realized interaction
roles rather than diversity in trait values per se. Because interactions
in bipartite networks reflect both trait matching and network structure,
functional richness defined from SBM-derived interaction guilds captures
realized ecological roles rather than only trait diversity.

![Figure B10: Changes in the functional richness of mammals along
climatic gradients across interaction guilds. Each row represents a
distinct mammal–palm interaction guild (IG-1 to IG-7), identified
through stochastic block modeling, while each column corresponds to an
environmental gradient: mean annual temperature (MAT, in °C), total
annual precipitation (TAP, in mm), temperature seasonality (TS,
expressed as the standard deviation of monthly temperature ×100), and
precipitation seasonality (PS, represented as the coefficient of
variation). In each panel, the y-axis shows the functional richness of
mammal communities, and the x-axis shows the corresponding environmental
gradient. Red smoothed lines represent observed trends in mammal
functional richness, while green smoothed lines represent trends for the
associated palm communities within the same guild. Shaded ribbons around
the smoothed lines indicate 95% confidence intervals. Background colors
delineate different interaction guilds to aid visual
interpretation.](images/clipboard-288217907.png)

::: callout
#### Table B2: Model estimates between FR and climate.

Parametric terms from separate GAMs predicting functional richness (FR) in palms (“FR
Palms”) and mammal frugivores (“FR Mammals”). The leftmost column lists
the model predictors: the intercept; four climatic main effects—Mean
Annual Temperature (MAT), Total Annual Precipitation (TAP), Temperature
Seasonality (TS), and Precipitation Seasonality (PS); and interaction
terms between each climate variable and the seven interaction guilds
(IG-1 through IG-7). Columns “Estimates,” “Std. Error,” and “p” give the
coefficient, its standard error, and significance for each predictor in
the palm and mammal models, respectively. “IG-n” refers to the nᵗʰ
palm–mammal guild as defined in the reference guild table. The bottom
rows report the number of grid‐cell observations and the model R² (or
adjusted R² for mammals).

```{r}
#| echo: false
#| message: false
#| warning: false
library(gt)
library(tibble)
library(dplyr)
library(stringr)

fr_table <- tribble(
  ~Predictor, ~Palms_Estimate, ~Palms_SE, ~Palms_p, ~Mammals_Estimate, ~Mammals_SE, ~Mammals_p,

  "(Intercept)", "8.28e-03", "8.58e-03", "0.335",  "1.35e-01", "1.52e-03", "<0.001",
  "Mean Annual Temperature (MAT)", "4.07e-04", "1.36e-04", "0.003", "4.42e-04", "4.48e-05", "<0.001",
  "Total Annual Precipitation (TAP)", "1.75e-05", "1.47e-05", "0.233", "6.42e-06", "4.95e-06", "0.153",
  "Temperature Seasonality (TS)", "-4.61e-05", "1.72e-04", "0.789", "3.88e-05", "8.13e-05", "0.633",
  "Precipitation Seasonality (PS)", "1.68e-04", "2.48e-04", "0.499", "2.06e-04", "1.35e-04", "0.128",

  "MAT × IG-1", NA, NA, "0.073", NA, NA, "0.011",
  "MAT × IG-2", NA, NA, "0.129", NA, NA, "0.010",
  "MAT × IG-3", NA, NA, "0.014", NA, NA, "0.331",
  "MAT × IG-4", NA, NA, "0.073", NA, NA, "0.001",
  "MAT × IG-5", NA, NA, "0.067", NA, NA, "0.010",
  "MAT × IG-6", NA, NA, "0.207", NA, NA, "0.002",
  "MAT × IG-7", NA, NA, "0.073", NA, NA, "0.003",

  "TAP × IG-1", NA, NA, "0.331", NA, NA, "0.322",
  "TAP × IG-2", NA, NA, "0.292", NA, NA, "0.541",
  "TAP × IG-3", NA, NA, "0.392", NA, NA, "0.552",
  "TAP × IG-4", NA, NA, "0.331", NA, NA, "0.449",
  "TAP × IG-5", NA, NA, "0.637", NA, NA, "0.541",
  "TAP × IG-6", NA, NA, "0.007", NA, NA, "0.950",
  "TAP × IG-7", NA, NA, "0.331", NA, NA, "0.436",

  "TS × IG-1", NA, NA, "0.864", NA, NA, "0.654",
  "TS × IG-2", NA, NA, "0.863", NA, NA, "0.849",
  "TS × IG-3", NA, NA, "0.868", NA, NA, "0.748",
  "TS × IG-4", NA, NA, "0.864", NA, NA, "0.678",
  "TS × IG-5", NA, NA, "0.890", NA, NA, "0.849",
  "TS × IG-6", NA, NA, "0.352", NA, NA, "0.920",
  "TS × IG-7", NA, NA, "0.864", NA, NA, "0.611",

  "PS × IG-1", NA, NA, "0.705", NA, NA, "0.225",
  "PS × IG-2", NA, NA, "0.199", NA, NA, "0.568",
  "PS × IG-3", NA, NA, "0.239", NA, NA, "0.748",
  "PS × IG-4", NA, NA, "0.705", NA, NA, "0.314",
  "PS × IG-5", NA, NA, "0.007", NA, NA, "0.568",
  "PS × IG-6", NA, NA, "0.001", NA, NA, "0.549",
  "PS × IG-7", NA, NA, "0.705", NA, NA, "0.361"
) %>%
  mutate(
    Palms_p_num = case_when(
      is.na(Palms_p) ~ NA_real_,
      str_detect(Palms_p, "<") ~ 0.001,
      TRUE ~ suppressWarnings(as.numeric(Palms_p))
    ),
    Mammals_p_num = case_when(
      is.na(Mammals_p) ~ NA_real_,
      str_detect(Mammals_p, "<") ~ 0.001,
      TRUE ~ suppressWarnings(as.numeric(Mammals_p))
    )
  )

fr_gt <- fr_table %>%
  gt() %>%
  tab_header(
    title = md("**Functional Richness (FR)**"),
    subtitle = md("FR Palms and FR Mammals model coefficients")
  ) %>%
  tab_spanner(
    label = md("**FR Palms**"),
    columns = c("Palms_Estimate", "Palms_SE", "Palms_p")
  ) %>%
  tab_spanner(
    label = md("**FR Mammals**"),
    columns = c("Mammals_Estimate", "Mammals_SE", "Mammals_p")
  ) %>%
  cols_label(
    Predictor = "Predictors",
    Palms_Estimate = "Estimates",
    Palms_SE       = "Std. Error",
    Palms_p        = html("p"),
    Mammals_Estimate = "Estimates",
    Mammals_SE       = "Std. Error",
    Mammals_p        = html("p")
  ) %>%
  fmt_missing(
    columns = c("Palms_Estimate", "Palms_SE", "Palms_p",
                "Mammals_Estimate", "Mammals_SE", "Mammals_p"),
    missing_text = ""
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = Palms_p, rows = !is.na(Palms_p_num) & Palms_p_num < 0.05)
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = Mammals_p, rows = !is.na(Mammals_p_num) & Mammals_p_num < 0.05)
  ) %>%
  tab_source_note(
    source_note = md("Observations = 9,009 (both models) | R² (Palms) = 0.012 | R² (Mammals) = -0.002")
  ) %>%
  cols_hide(columns = c("Palms_p_num", "Mammals_p_num")) %>%
  opt_table_outline()

fr_gt

```
:::

### Measuring FTA

Functional trophic asymmetry was calculated as the absolute difference
between the normalized palm and mammal guild proportions, capturing the
degree to which interaction guild composition differs between resources
and consumers within the same assemblage. This resulted on 49 individual
metrics (7 x 7 ) of FTA per gridcell, each representing a unique
interaction guild combination.

::: callout
#### Equation 7

$$\mathrm{FTA}_{g_ig_j} = \left|Fr^{P}_{g_i} - Fr^{M}_{g_j}\right|$$

**where:** ($\mathrm{FTA}_{g_i g_j}$) is the functional trophic
asymmetry between palms and mammals for interaction guilds combinations
between palms ($g_i$) and mammals ($g_j$); ($Fr^{P}_{g_i}$) is the
relative proportion of palm species assigned to guild ($g_i$); and
($Fr^{M}_{g_j}$) is the relative proportion of mammal species assigned
to guild ($g_j$).
:::

![Figure S4: Ridgeline densities of Functional Trophic Asymmetry (FTA)
for each realized mammal–palm “interaction guild” (mXpY) across
Neotropical grid cells. Each label on the y-axis—e.g. m3p2—denotes the
pairing of mammal guild 3 (small-bodied, low-frugivory, predominantly
nocturnal species: mean mass ≈ 4.75 kg; 21.7 % fruit diet; 84 %
nocturnal) with palm guild 2 (tall, small-fruited, erect palms: 25
species; mean height ≈ 3.05 m; fruit length ≈ 0.8 cm; 100 % erect). The
x-axis shows FTA values (0 = symmetrical trait distributions, 1 =
maximal mismatch), and each ridge plots the distribution of FTA across
all grid cells where that guild pair co-occurs. Guilds combining large,
low-frugivory mammals (e.g. m6) with short, large-fruited palms (p6)
(see table 3 for trait distribution reference) exhibit the highest
asymmetry (densities shifted right), whereas guilds of small, highly
frugivorous mammals paired with tall, small-fruited palms (e.g. m1p2)
cluster near zero.](images/clipboard-2134524700.png)

We summed FTA values across all interaction guild combinations to obtain
an aggregate metric of FTA per grid cell $FTA_{sum}$.

::: callout
#### Equation 8

$$\mathrm{FTA}_{\mathrm{sum}} = \sum_{g=1}^{G}  \mathrm{FTA_g} $$

**where:** ($\mathrm{FTA}_{sum}$) is the aggregate functional trophic
asymmetry across all interaction guilds; ($G$) is the total number of
palm-mammal interaction guilds combinations inferred by the stochastic
block model (49); ($\mathrm{FTA}$) is the functional trophic asymmetry
between palms and mammals guilds.
:::

![\*\*Figure X. Distribution of summed Functional Trophic Asymmetry
(FTA(\_{\\mathrm{sum}})) across Neotropical grid cells.\*\* The
histogram shows the frequency distribution of
(\\mathrm{FTA}\_{\\mathrm{sum}}), which aggregates absolute trait
asymmetries across all interacting mammal–palm guild pairs within each
grid cell. Higher values indicate greater overall mismatch in functional
traits between consumer and resource assemblages, whereas lower values
reflect more symmetric guild
composition.](images/clipboard-2272296321.png)

Because $FTA_{sum}$ can be sensitive to asymmetries arising in weakly
connected parts of the network, weighting functional trophic asymmetry
by inter-guild interaction strength accounts for the fact that not all
guild mismatches are equally relevant to network organization. The
adjusted metric therefore prioritizes asymmetry in strongly interacting
guild pairs, providing a more ecologically meaningful measure of trophic
imbalance.

::: callout
#### Equation 9

$$\mathrm{FTA}_{sum_{adj}} = \sum_{g=1}^{G} FTA \times I_{g_ig_j}$$

**where:** ($I_{g_i g_j}$) is the strenght of interaction between
palm-mammal guilds.
:::

![\*\*Figure X. Distribution of adjusted summed Functional Trophic
Asymmetry (FTA(\_{\\mathrm{sum,adj}})) across Neotropical grid
cells.\*\* The histogram depicts the frequency distribution of the
interaction-weighted FTA metric, in which trait asymmetries among
mammal–palm guild pairs are scaled by the strength of their inferred
interactions. This adjustment down-weights rare or weakly connected
guild combinations, emphasizing asymmetry arising from ecologically
dominant interactions and providing a more conservative measure of
functional mismatch at the assemblage
level.](images/clipboard-3422516409.png)

#### Evaluating the relationship between FTA and interaction strength

To ensure that the interaction‐weighted adjustment did not introduce
systematic bias, we explicitly tested whether the $FTA_{sum_{adj}}$was
correlated with interaction strength. *T*his assessment verifies that
the adjustment does not trivially inflate or deflate asymmetry values as
a direct function of interaction intensity, but instead preserves FTA as
an independent measure of trait mismatch.

![Figure S7: Relationship between interaction strength and Functional
Trophic Asymmetry (FTA) for 43/49 grid‐cell–interaction guild
observations. Points show the median FTA values plotted against
interaction strength, with the blue line and grey band representing the
fitted linear regression (±95 % CI). The model intercept significantly
different from 0, 0.19 (95 % CI 0.12–0.25, p \< 0.001), but the slope
for interaction strength is small and non‐significant (β = 0.18, 95 % CI
–0.27 to 0.62, p = 0.426).](images/clipboard-924046659.png)

::: callout
####Table B3: Simple linear regression of adjusted Functional Trophic Asymmetry (FTA) on interaction strength.

The intercept of 0.19 (95 % CI: 0.12–0.25, p \< 0.001) represents the baseline FTA when interaction
strength is zero, while the slope coefficient for interaction strength
is 0.18 (95 % CI: –0.27–0.62, p = 0.426), indicating that variation in
interaction strength does not significantly predict changes in FTA.

```{r}
#| echo: false
#| message: false
#| warning: false
mod_table <- tribble(
  ~Predictor, ~Estimate, ~CI, ~p,
  "(Intercept)", "0.19", "0.12 – 0.25", "<0.001",
  "Interaction strength", "0.18", "-0.27 – 0.62", "0.426"
) %>%
  mutate(
    p_num = if_else(str_detect(p, "<"), 0.001, as.numeric(p))
  )

mod_gt <- mod_table %>%
  gt() %>%
  tab_header(
    title = md("**Model Results**"),
    subtitle = md("Coefficient estimates with 95% confidence intervals")
  ) %>%
  cols_label(
    Predictor = "Predictors",
    Estimate  = "Estimates",
    CI        = "CI",
    p         = html("p")
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = p, rows = p_num < 0.05)
  ) %>%
  fmt_missing(
    columns = everything(),
    missing_text = ""
  ) %>%
  tab_source_note(
    source_note = md("Observations = 43 | R² / R² adjusted = 0.016 / -0.008")
  ) %>%
  cols_hide(p_num) %>%
  opt_table_outline()

mod_gt

```
:::


### Does climate determine FTA?

We used generalized additive models (mgcv) to relate the response to
climatic predictors—mean annual temperature (Temp), precipitation
seasonality (PS), temperature seasonality (TS), and total annual
precipitation (Prec)—and to interaction strength (int_str). Each climate
variable was included as a univariate smooth s(⋅) (thin-plate regression
spline; k=9k=9k=9), and potential modulation by interaction strength was
modeled using smooth interaction terms s(climate,int_str)(k=27). A
separate smooth s(int_str) captured nonlinear effects of interaction
strength. Smoothing parameters were selected by generalized
cross-validation (GCV) using the *magic* optimizer. Model adequacy was
evaluated using mgcv basis-dimension checks (k-index), effective degrees
of freedom, and residual diagnostics.

Checks on the basis dimensions show no evidence that any smooth term is
underfit: the climatic predictors (temperature, precipitation, and their
seasonalities) have effective degrees of freedom close to one and
k-indices near one with high p-values, indicating that their effects are
approximately linear and adequately captured by the chosen smooths.
Interaction terms between climate variables and interaction strength
show very low complexity. In contrast, the smooth term for interaction
strength alone is highly flexible and strongly supported, indicating a
pronounced nonlinear relationship. Convergence diagnostics indicate a
stable and well-conditioned model.

::: callout
#### Table B4. Basis-dimension diagnostics for generalized additive model smooth terms.
The table reports the basis dimension ((k′)), effective degrees of
freedom (EDF), k-index, and associated p-values for each smooth term.

```{r}
#| echo: false
#| message: false
#| warning: false


gam_diag_tbl <- tribble(
  ~Smooth, ~k_prime, ~edf, ~k_index, ~p_value, ~sig,
  "s(Temp)",           9.00, 1.00, 1.02, "0.80",        "",
  "s(Temp, int_str)", 27.00, 0.015, 1.02, "0.96",        "",
  "s(PS)",             9.00, 1.00, 1.03, "0.97",        "",
  "s(PS, int_str)",   27.00, 1.77, 1.02, "0.94",        "",
  "s(TS)",             9.00, 1.00, 1.02, "0.96",        "",
  "s(TS, int_str)",   27.00, 0.000004, 1.02, "0.87",    "",
  "s(Prec)",           9.00, 1.00, 1.01, "0.73",        "",
  "s(Prec, int_str)", 27.00, 1.74, 1.01, "0.68",        "",
  "s(int_str)",        9.00, 9.00, 0.62, "< 2e-16", "***"
)

gam_diag_gt <-
  gam_diag_tbl |>
  gt() |>
  tab_header(
    title = md("**GAM basis-dimension diagnostics**"),
    subtitle = md("Results of k-index and effective degrees of freedom checks")
  ) |>
  cols_label(
    Smooth  = "Smooth term",
    k_prime = html("k′"),
    edf     = "EDF",
    k_index = "k-index",
    p_value = html("p"),
    sig     = ""
  ) |>
  fmt_number(
    columns = c(k_prime, edf, k_index),
    decimals = 2
  ) |>
  cols_align(
    align = "center",
    columns = c(k_prime, edf, k_index, p_value, sig)
  ) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(rows = sig == "***")
  ) |>
  tab_source_note(
    source_note = md(
      "Low k-index values (< 1) with significant p-values indicate potential undersmoothing. Only the smooth for interaction strength shows evidence of requiring high flexibility."
    )
  ) |>
  opt_table_outline() |>
  opt_row_striping()

gam_diag_gt

```
::: 


![Figure S8. Estimated smooth relationships from a GAM of Functional
Trophic Asymmetry (FTA) against four climatic variables and interaction
strength. Across all panels, mean annual temperature (Temp) shows a
gentle, positive association with FTA, while total precipitation and
temperature seasonality exert negligible or slightly negative effects.
Precipitation (Prec) seasonality likewise produces only a weak upward
trend at high values. Importantly, none of the tensor‐product
interaction terms between interaction strength and any climate variable
deviate meaningfully from zero, indicating that interaction strength
(int_str) does not modify how climate influences trait asymmetry. The
standalone smooth for interaction strength itself exhibits undulating
but statistically uncertain variation, suggesting no clear direct
effect. Shaded bands around each curve denote approximately 95 %
confidence intervals, and tick marks along the axes mark the range of
observed data.](images/clipboard-3768095388.png)

### Does FTA influence network structure?

We examine the variation in network structure with network
specialization and the spectral radius. We computed a metric of
network-level specialization (H2') that is independent of network size
and marginal totals. The metric is computed from the interaction matrix
by comparing the deviation of interaction frequencies from a null
expectation based on species’ total interaction frequencies, and is then
normalized to range between 0 (no specialization, complete
generalization) and 1 (maximum specialization). In addition, we used the
spectral radius as a complementary metric of network structure. The
spectral radius is computed as the largest eigenvalue of the (weighted
or binary) interaction matrix. This metric captures the dominant mode of
interaction structure in the network, reflecting how strongly
interactions are concentrated along a few highly connected species or
pathways. A larger spectral radius indicates a more centralized
interaction structure dominated by generalists, whereas lower values
suggest interactions that are more evenly distributed creating diffuse
networks.

![Figure X. Relationship between network specialization and structural
concentration. Scatterplot showing grid-cell values of network
specialization (H2′) plotted against the log-transformed spectral radius
of the interaction matrix.](images/clipboard-3266454264.png)

We control for differences in sampling intensity and network size by
standardizing interaction data to a common level of observation.
Specifically, we used `rarefy` function from `cassandRa` to repeatedly
subsample interactions from the original bipartite gridcell level
network to a fixed number (100) of interactions and recalculates network
structural metrics (i.e network specialization, structural radius) on
each subsample. We used the median of this subsampled distribution as
the gridcell metric of network structure. This procedure reduces biases
that arise because larger or more densely sampled assemblages tend to
exhibit higher connectance.

![](images/clipboard-321485642.png)

#### Evaluating the relationship between FTA and H2'

![**Figure S9.Functional trophic asymmetry predicts network
specialization.** Scatterplot shows the relationship between adjusted
functional trophic asymmetry and network specialization across grid cell
and guild observations in the Neotropics. Each point represents a local
assemblage, illustrating how increasing trophic asymmetry is associated
with higher levels of interaction
specialization](images/clipboard-3970149461.png)

::: callout
#### Table B5: Simple linear model relating network specialization (H2′) to total functional trophic asymmetry (FTAsum).

The model intercept is
–0.03 (95 % CI: –0.13–0.06, p = 0.489), and FTAsum has a positive
estimate of 0.05 (95 % CI: 0.02–0.07, p \< 0.001), suggesting a small
but statistically significant increase in specialization with greater
trait mismatch.

```{r}
#| echo: false
#| message: false
#| warning: false

ns2_table <- tribble(
  ~Predictor, ~Estimate, ~CI, ~p,
  "(Intercept)", "-0.03", "-0.13 – 0.06", "0.489",
  "FTAsum", "0.05", "0.02 – 0.07", "<0.001"
) %>%
  mutate(
    p_num = if_else(str_detect(p, "<"), 0.001, as.numeric(p))
  )

ns2_gt <- ns2_table %>%
  gt() %>%
  tab_header(
    title = md("**Network specialization**"),
    subtitle = md("Coefficient estimates with 95% confidence intervals")
  ) %>%
  cols_label(
    Predictor = "Predictors",
    Estimate  = "Estimates",
    CI        = "CI",
    p         = html("p")
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = p, rows = p_num < 0.05)
  ) %>%
  fmt_missing(columns = everything(), missing_text = "") %>%
  tab_source_note(
    source_note = md("Observations = 1,242 | R² / R² adjusted = 0.012 / 0.012")
  ) %>%
  cols_hide(p_num) %>%
  opt_table_outline()

ns2_gt

```
::: 


#### Evaluating the relationship between FTA and the spectral radius

![**Figure X. Functional trophic asymmetry predicts network spectral
radius.** Scatterplot shows the relationship between adjusted functional
trophic asymmetry and the logarithm of the spectral radius of
interaction networks after rarefaction to control for sampling effects.
Each point represents a rarefied network realization, with the fitted
regression line and confidence interval illustrating a strong positive
association.](images/clipboard-1692998543.png)


::: callout
#### Table B6: Effect of functional trophic asymmetry on network spectral radius.

The table show the results of a simple linear regression
showing the relationship between functional trophic asymmetry and
spectral radius. Estimates indicate a strong positive association, with
higher asymmetry corresponding to networks that are more ordered, with
lower-dimensional interaction structure.

```{r}
#| echo: false
#| message: false
#| warning: false

tibble(
  Term = c("Intercept", "Functional trophic asymmetry"),
  Estimate = c(-7.574, 18.380),
  `Std. Error` = c(1.299, 1.374),
  `t value` = c(-5.832, 13.381),
  `p value` = c("< 0.01", "< 0.01")
) |>
  gt() |>
  fmt_number(
    columns = c(Estimate, `Std. Error`, `t value`),
    decimals = 3
  ) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = `p value`)
  ) |>
  tab_header(
     title = md("**Spectral radius**"),
    subtitle = md("Coefficient estimates with 95% confidence intervals")
  ) |>
  tab_source_note(
    source_note = md(
      "Model fit: residual standard error = 5.01 (df = 1240);  
      R² = 0.126; adjusted R² = 0.126; F(1, 1240) = 179, p < 0.01."
    )
  )%>%
  opt_table_outline()



```
:::

